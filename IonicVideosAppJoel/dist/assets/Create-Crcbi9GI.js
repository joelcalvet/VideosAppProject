import{r as m,k as f,d as I,c as g,w as r,u as l,I as M,e as i,n as y,p as V,j as p,q as x,g as C,h as w,K as j,L as c,i as S,f as T,o as _}from"./index-g3H4iXOq.js";const k={multimedia:m([]),userMultimedia:m([]),async fetchMultimedia(){try{const e=await f.get("/multimedia");this.multimedia.value=e.data}catch(e){console.error("Error carregant multimèdia:",e)}},async fetchUserMultimedia(){try{const e=await f.get("/user/multimedia");this.userMultimedia.value=e.data}catch(e){console.error("Error carregant el meu multimèdia:",e)}},addMultimedia(e){this.multimedia.value.push(e),this.userMultimedia.value.push(e)},updateMultimedia(e){const t=this.multimedia.value.findIndex(o=>o.id===e.id);t!==-1&&(this.multimedia.value[t]=e);const u=this.userMultimedia.value.findIndex(o=>o.id===e.id);u!==-1&&(this.userMultimedia.value[u]=e)},deleteMultimedia(e){this.multimedia.value=this.multimedia.value.filter(t=>t.id!==e),this.userMultimedia.value=this.userMultimedia.value.filter(t=>t.id!==e)}},E=I({__name:"Create",setup(e){const t=m(""),u=m(""),o=m(null),v=s=>{const a=s.target;a.files&&(o.value=a.files[0])},h=async()=>{var a,d;if(!o.value||!u.value){alert("Selecciona un fitxer i un tipus.");return}const s=new FormData;s.append("file",o.value),s.append("type",u.value),s.append("title",t.value||"");try{const n=await f.post("/multimedia",s,{headers:{"Content-Type":"multipart/form-data"}});k.addMultimedia(n.data),t.value="",u.value="",o.value=null,alert("Pujat correctament!")}catch(n){console.error("Error pujant:",n),console.error("Detalls de l'error:",(a=n.response)==null?void 0:a.data),((d=n.response)==null?void 0:d.status)===422&&(console.error("Validation errors:",n.response.data.errors),alert("Error: ".concat(n.response.data.message)))}};return(s,a)=>(_(),g(l(M),null,{default:r(()=>[i(l(x),null,{default:r(()=>[i(l(y),{color:"primary"},{default:r(()=>[i(l(V),null,{default:r(()=>a[2]||(a[2]=[p("Pujar")])),_:1})]),_:1})]),_:1}),i(l(T),{class:"ion-padding"},{default:r(()=>[i(l(w),{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=d=>t.value=d),placeholder:"Títol"},null,8,["modelValue"]),i(l(j),{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=d=>u.value=d),placeholder:"Selecciona el tipus"},{default:r(()=>[i(l(c),{value:"photo"},{default:r(()=>a[3]||(a[3]=[p("Foto")])),_:1}),i(l(c),{value:"video"},{default:r(()=>a[4]||(a[4]=[p("Vídeo")])),_:1})]),_:1},8,["modelValue"]),C("input",{type:"file",onChange:v,accept:"image/*,video/*"},null,32),i(l(S),{onClick:h},{default:r(()=>a[5]||(a[5]=[p("Pujar")])),_:1})]),_:1})]),_:1}))}});export{E as default};
